# 공통 기능 요구사항

---

## 1. 엑셀 출력

- 출력 대상: 현재 검색 조건에 해당하는 전체 데이터 (현재 페이지가 아닌 검색 결과 전체)
- 출력 컬럼: 화면에 표시되는 컬럼과 동일
- 파일명 규칙: `{화면명}_{YYYYMMDD}.xlsx`
- 최대 출력 건수: 10,000건으로 제한되어야 하며, 초과 시 안내 메시지가 표시되어야 한다
- 출력 중 로딩 표시가 나타나야 한다
- 엑셀/출력 버튼은 표준 CRUD 화면(템플릿 A)과 조회 전용 화면(템플릿 B) 모든 목록 화면에 제공되어야 한다
- 목록-상세 전환형 화면(템플릿 E)에서도 목록 상태일 때 엑셀/출력 버튼이 제공되어야 한다
- 모니터링 화면(템플릿 C)과 특수 화면(템플릿 D)에서는 화면 성격에 따라 선택적으로 제공한다

---

## 2. 인쇄

- 인쇄 버튼 클릭 시 현재 화면의 목록 영역이 인쇄 가능한 레이아웃으로 표시되어야 한다
- 검색 조건, 사이드바, 상단 바 등 불필요한 영역은 인쇄에서 제외되어야 한다

---

## 3. 데이터 저장 / 수정

- 저장 버튼 클릭 시 확인 팝업 없이 즉시 저장되어야 한다 (삭제와 구분)
- 저장 성공 시 "저장되었습니다" 토스트 메시지가 표시되어야 한다
- 저장 실패 시 오류 내용이 팝업으로 표시되어야 한다
- 필수 항목 미입력 시 해당 항목 하단에 "필수 입력 항목입니다" 메시지가 표시되고, 해당 항목으로 포커스가 이동되어야 한다
- 저장 성공 후 팝업이 닫히고 목록이 자동으로 갱신되어야 한다
- 인라인 편집 그리드에서의 일괄 저장 시에도 동일한 성공/실패 처리가 적용되어야 한다

---

## 4. 삭제

- 단건 삭제: 수정 팝업 내 삭제 버튼으로 수행
- 다건 삭제: 목록에서 체크박스로 다중 선택 후 일괄 삭제 (해당 화면에 한함)
- 삭제 전 확인 팝업 문구: "정말로 '{대상명}'을(를) 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."
- 삭제 성공 후 목록이 현재 페이지 기준으로 자동 갱신되어야 한다
- 삭제 성공 시 "삭제되었습니다" 토스트 메시지가 표시되어야 한다
- 연관 데이터가 존재하는 경우 삭제가 거부되어야 하며, "연관된 데이터가 있어 삭제할 수 없습니다. (연관: {관련항목})" 메시지가 표시되어야 한다

---

## 5. 페이지 이동 / 네비게이션

- 수정 중인 데이터가 있는 상태에서 팝업을 닫거나 탭을 전환할 경우 "저장하지 않은 변경사항이 있습니다. 이동하시겠습니까?" 경고가 표시되어야 한다
- 저장 성공 후 팝업이 자동으로 닫히고 목록 화면으로 복귀되어야 한다
- 템플릿 E (목록-상세 전환형) 화면에서 상세→목록 전환 시에도 동일한 변경사항 확인이 적용되어야 한다

---

## 6. 권한별 화면 제어

- **읽기 권한만 있는 사용자**: 등록/수정/삭제 버튼이 숨김 처리되어야 한다. 목록 조회와 상세 보기만 가능하여야 한다.
- **쓰기 권한이 있는 사용자**: 모든 기능이 활성화되어야 한다
- **권한이 없는 메뉴**: 사이드바에서 해당 메뉴가 표시되지 않아야 한다
- **권한 없는 URL 직접 접근 시**: "접근 권한이 없습니다" 메시지와 함께 홈 화면으로 이동되어야 한다

---

## 7. 공통 메시지 / 알림 체계

| 유형 | 표시 위치 | 표시 시간 | 예시 문구 |
|------|-----------|-----------|-----------|
| 성공 | 화면 우상단 토스트 | 3초 후 자동 닫힘 | "저장되었습니다." / "삭제되었습니다." |
| 실패 / 오류 | 팝업 (확인 버튼 포함) | 사용자가 확인 클릭 시 닫힘 | "처리 중 오류가 발생했습니다. [상세 원인]" |
| 경고 | 팝업 (확인/취소 버튼 포함) | 사용자가 버튼 클릭 시 닫힘 | "삭제 후 복구할 수 없습니다. 계속하시겠습니까?" |
| 유효성 오류 | 해당 입력 항목 하단 인라인 | 해당 항목 수정 시 자동 해제 | "필수 입력 항목입니다." / "최대 50자까지 입력 가능합니다." |
| 안내 | 화면 내 배너 영역 | 상시 표시 | "상위 메뉴를 선택하거나 루트 메뉴로 등록하세요." |
| Reload 결과 | Reload 팝업 내 인라인 | 사용자가 닫기 클릭 시 닫힘 | "WAS01: 성공 / WAS02: 실패 - 연결 타임아웃" |

---

## 8. 날짜 기본값 규칙

날짜 범위 필터가 있는 화면에서의 기본값 적용 기준이다.

| 화면 유형 | 기본 조회 기간 | 적용 화면 |
|-----------|---------------|-----------|
| 이력/감사 조회 화면 | 최근 1개월 | 관리자 작업 이력, 거래 중지 이력 |
| 오류 조회 화면 | 최근 1개월 | 오류 발생 현황, 에러 내역 통계, 오류 핸들러 수행 내역 |
| 거래 중지 관리 | 최근 1개월 | 거래 중지 관리 |
| 배치 수행 내역 | 오늘 (당일) | 배치 수행 내역 |
| 전문 테스트 | 오늘 (당일) | 전문 테스트 |
| 거래 추적 로그 | 최근 1일 | 거래 추적 로그 조회 |
| 전송 데이터 | 최근 1개월 | 전송 데이터 관리, 전송 데이터 파일 |

- 기간 조회 화면은 시작일이 종료일보다 이후일 수 없다.
- 단일 날짜 조회 화면(배치 수행 내역, 전문 테스트)은 달력 팝업으로 날짜를 선택한다.
- 모든 날짜 표시 형식은 `YYYY-MM-DD`이다.
- 날짜/시간 표시 형식은 `YYYY-MM-DD HH:mm:ss`이다.

---

## 9. 유사 복사

기존 데이터를 기반으로 새로운 데이터를 등록할 때 사용하는 기능이다. 레거시 시스템의 "유사등록" 기능을 표준화한 것이다.

### 적용 화면

| 화면명 | 복사 대상 | 사용자 수정 필수 항목 |
|--------|-----------|----------------------|
| 거래 관리 | 거래 정보 + 전문 맵핑 | 거래 코드 (신규 입력) |
| 서비스 관리 | 서비스 정보 + 컴포넌트 구성 | 서비스 ID (신규 입력) |
| 속성 관리 | 속성값 + 그룹 정보 | 속성 ID (신규 입력) |
| 전문 관리 | 전문 구조 + 필드 정의 | 전문 ID (신규 입력) |

### 동작 요구사항

- 목록에서 기존 항목을 선택한 후 "유사 복사" 버튼을 클릭하면 등록 팝업(또는 상세 화면)이 열려야 한다.
- 선택한 항목의 모든 데이터가 입력 필드에 사전 입력되어야 한다.
- 식별자(ID) 항목은 빈 값으로 초기화되어 사용자가 새로 입력하여야 한다.
- 등록 모드로 동작하여야 한다 (저장 시 신규 INSERT).
- "유사 복사" 버튼은 쓰기 권한 보유자에게만 노출되어야 한다.

---

## 10. 백업/복원

데이터 변경 전에 현재 상태를 백업하고, 필요 시 이전 상태로 복원하는 기능이다. 레거시 시스템의 "백업/원복" 기능을 표준화한 것이다.

### 적용 화면

| 화면명 | 백업 단위 | 복원 범위 |
|--------|-----------|-----------|
| 전문 관리 | 전문 단위 (전문 구조 + 필드 정의 전체) | 선택한 백업 시점으로 전체 복원 |
| 속성 관리 | 속성 그룹 단위 | 그룹 내 모든 속성을 백업 시점으로 복원 |

### 동작 요구사항

- **백업 생성**: 수정 화면에서 "백업" 버튼 클릭 시 현재 상태가 저장되어야 한다. 백업 시 메모(사유) 입력을 선택적으로 할 수 있어야 한다.
- **백업 목록 조회**: 백업 이력(일시, 수행자, 메모)이 목록으로 표시되어야 한다.
- **복원**: 백업 목록에서 항목을 선택하고 "복원" 버튼을 클릭하면 해당 시점으로 데이터가 복원되어야 한다. 복원 전 "현재 데이터가 백업 시점({YYYY-MM-DD HH:mm})의 데이터로 대체됩니다. 계속하시겠습니까?" 확인 팝업이 표시되어야 한다.
- **삭제**: 불필요한 백업을 삭제할 수 있어야 한다.
- 백업/복원 버튼은 쓰기 권한 보유자에게만 노출되어야 한다.
